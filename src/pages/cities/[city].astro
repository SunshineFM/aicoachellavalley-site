---
import ActionCard from "../../components/ActionCard.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";
import PageHero from "../../components/PageHero.astro";
import { CITIES } from "../../data/cities";

export function getStaticPaths() {
  return CITIES.map((city) => ({
    params: { city: city.slug },
  }));
}

const cityParam = (Astro.params.city || "").toLowerCase();
const city = CITIES.find((entry) => entry.slug === cityParam);

if (!city) {
  return Astro.redirect("/cities", 302);
}
---

<BaseLayout title={`${city.name} | Cities | AI Coachella Valley`}>
  <PageHero
    title={city.name}
    description={city.shortDescription}
  />

  <section>
    <h2>What we're tracking</h2>
    <ul class="tracking-list">
      {city.signalsWeTrack.map((signal) => (
        <li>{signal}</li>
      ))}
    </ul>
  </section>

  <section>
    <h2>Key sectors</h2>
    <ul class="sector-list">
      {city.keySectors.map((sector) => (
        <li>{sector}</li>
      ))}
    </ul>
  </section>

  <section>
    <h2>Top Paths</h2>
    <div class="path-grid">
      <ActionCard
        title="View all briefs"
        description="Browse the latest city-tagged evidence and regional updates."
        href="/briefs"
        buttonLabel="Open Briefs"
      />
      <ActionCard
        title="Submit a brief"
        description="Share a verified local signal or implementation update."
        href="/submit"
        buttonLabel="Open Submit a Brief"
      />
      <ActionCard
        title="State of AI"
        description="Read the current narrative snapshot for this city."
        href={`/state-of-ai/${city.slug}`}
        buttonLabel={`Open ${city.name} State of AI`}
      />
    </div>
  </section>

  <p><a href="/cities">Back to All Cities</a></p>
</BaseLayout>

<style>
  section + section {
    margin-top: var(--s-7);
  }

  .path-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(16rem, 1fr));
    gap: var(--s-4);
  }

  .tracking-list,
  .sector-list {
    margin: 0;
    padding-left: 1.2rem;
    display: grid;
    gap: var(--s-2);
  }

  p > a {
    color: var(--c-indigo);
    font-weight: 600;
  }
</style>
