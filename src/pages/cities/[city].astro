---
import ActionCard from "../../components/ActionCard.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";
import PageHero from "../../components/PageHero.astro";

const CITY_PAGES = [
  { name: "Palm Springs", slug: "palm-springs" },
  { name: "Desert Hot Springs", slug: "desert-hot-springs" },
  { name: "Cathedral City", slug: "cathedral-city" },
  { name: "Rancho Mirage", slug: "rancho-mirage" },
  { name: "Palm Desert", slug: "palm-desert" },
  { name: "Indian Wells", slug: "indian-wells" },
  { name: "Indio", slug: "indio" },
  { name: "La Quinta", slug: "la-quinta" },
  { name: "Coachella", slug: "coachella" },
] as const;

export function getStaticPaths() {
  return CITY_PAGES.map((city) => ({
    params: { city: city.slug },
  }));
}

const cityParam = (Astro.params.city || "").toLowerCase();
const city = CITY_PAGES.find((entry) => entry.slug === cityParam);

if (!city) {
  return Astro.redirect("/cities", 302);
}
---

<BaseLayout title={`${city.name} | Cities | AI Coachella Valley`}>
  <PageHero
    title={`${city.name} Briefs`}
    description={`City-level briefs and signals for ${city.name}.`}
  />

  <section>
    <h2>Top Paths</h2>
    <div class="path-grid">
      <ActionCard
        title="View all briefs"
        description="Browse the latest regional evidence and updates."
        href="/briefs"
        buttonLabel="Open Briefs"
      />
      <ActionCard
        title="Submit a brief"
        description="Share a verified local signal or implementation update."
        href="/submit"
        buttonLabel="Open Submit a Brief"
      />
    </div>
  </section>

  <p><a href="/cities">Back to All Cities</a></p>
</BaseLayout>

<style>
  section + section {
    margin-top: var(--s-7);
  }

  .path-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(16rem, 1fr));
    gap: var(--s-4);
  }

  p > a {
    color: var(--c-indigo);
    font-weight: 600;
  }
</style>
